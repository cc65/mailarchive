<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Register variables</title>
<meta name="Author" content="Marko Mäkelä (msmakela_at_cc.hut.fi)">
<meta name="Subject" content="Re: [cc65] Register variables">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Register variables</h1>
<!-- received="Mon Jul 19 08:15:25 1999" -->
<!-- isoreceived="19990719061525" -->
<!-- sent="Mon, 19 Jul 1999 09:14:50 +0300 (EET DST)" -->
<!-- isosent="19990719061450" -->
<!-- name="Marko Mäkelä" -->
<!-- email="msmakela_at_cc.hut.fi" -->
<!-- subject="Re: [cc65] Register variables" -->
<!-- id="Pine.OSF.4.10.9907190906540.28537-100000@meripihka.hut.fi" -->
<!-- inreplyto="m115EJf-000brTC@wuschel.musoftware.de" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Marko Mäkelä (<a href="mailto:msmakela_at_cc.hut.fi?Subject=Re:%20[cc65]%20Register%20variables"><em>msmakela_at_cc.hut.fi</em></a>)<br>
<strong>Date:</strong> 1999-07-19 08:14:50
<p>
<!-- next="start" -->
<ul>
<li><strong>Next message:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<li><strong>Previous message:</strong> <a href="1005.html">Ullrich von Bassewitz: "[cc65] Register variables"</a>
<li><strong>In reply to:</strong> <a href="1005.html">Ullrich von Bassewitz: "[cc65] Register variables"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<li><strong>Reply:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
On Fri, 16 Jul 1999, Ullrich von Bassewitz wrote:

&gt; Variable c is assigned to the first byte in the register space. When calling
&gt; f(), a pointer to this location is passed. Unfortunately the variable i will
&gt; occupy the same space as c: The old value is saved and the storage is reused.

Couldn't you forbid the &amp; operator for register variables?  Or save the
register calls on the stack before the function call and pass the address
of the stack location?  Note that for the latter, you must handle nested
function calls properly, e.g. f(g(&amp;x)) must store x on stack before
calling g and restore it after calling x.  And I think the standard would
allow you to do f(g(&amp;x),x) in the same way: even if g() modifies x, it is
implementation-defined whether f() gets the modified x as its second
parameter.

Remember that you will have to store register variables on stack every
time you call a function that has register variables or that calls a
function that has register variables.  I guess it's easiest to always
store the register variables before every function call.  Some life-time
analysis could be useful: if a variable is only used in the beginning of
a function, you can discard it when doing a function call at the end of
the function.

&gt; But the current compiler implementation does not generate explicit
&gt; parse trees, and adding it is a real lot of work

How does it work then?  What kind of a parser is it?  Hand-written
top-down or what?

	Marko

----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Register%20variables">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Next message:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<li><strong>Previous message:</strong> <a href="1005.html">Ullrich von Bassewitz: "[cc65] Register variables"</a>
<li><strong>In reply to:</strong> <a href="1005.html">Ullrich von Bassewitz: "[cc65] Register variables"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<li><strong>Reply:</strong> <a href="1007.html">Ullrich von Bassewitz: "Re: [cc65] Register variables"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2001-12-14 22:05:44 CET</em>
</em>
</small>
</body>
</html>
