<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: [cc65] Atari file i/o functions</title>
<meta name="Author" content="Shawn Jefferson (sjefferson_at_sd62.bc.ca)">
<meta name="Subject" content="[cc65] Atari file i/o functions">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>[cc65] Atari file i/o functions</h1>
<!-- received="Tue Apr 23 22:08:38 2002" -->
<!-- isoreceived="20020423200838" -->
<!-- sent="Tue, 23 Apr 2002 13:08:28 -0700" -->
<!-- isosent="20020423200828" -->
<!-- name="Shawn Jefferson" -->
<!-- email="sjefferson_at_sd62.bc.ca" -->
<!-- subject="[cc65] Atari file i/o functions" -->
<!-- id="scc55cda.025@gwmail.sd62.bc.ca" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Shawn Jefferson (<a href="mailto:sjefferson_at_sd62.bc.ca?Subject=Re:%20[cc65]%20Atari%20file%20i/o%20functions"><em>sjefferson_at_sd62.bc.ca</em></a>)<br>
<strong>Date:</strong> 2002-04-23 22:08:28
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="1285.html">Ullrich von Bassewitz: "[cc65] cc65 runtime module loader (was: 65816)"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1288.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1290.html">Christian Groessler: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1298.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1300.html">Christian Groessler: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1301.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1302.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
I was doing some programming on the Atari with the C file i/o functions and I noticed that fseek and ftell, and fopen with append are not implemented.

I took a look at the source for the atari library and I figured that fseek and ftell could be implemented for SpartaDOS fairly easily, since SpartaDOS implements a sane NOTE and POINT functions in the FMS.  POINT is XIO#37 and NOTE is XIO #38.  AtariDOS is another story since it doesn't use an offset from the beginning of the file like SpartaDOS... it uses sector and byte!  Ugh!

Unfortunately, my grasp of assembler is weak.  I've attempted to code the ftell function (only implementing seeking from the beginning of the file at the moment) but haven't tested it as I don't even know if I can build the Atari lib myself or not.

Also... looking at the way the functions are layed out.. fseek calls lseek in the atari library... and ftell calls lseek as well.  That doesn't seem like the best way to do it, since you will want to call lseek with different offsets depending on what whence is (SEEK_SET, SEEK_CUR, SEEK_END) and ftell would/should just call the CIO with command 38 to get the current file position.

How tied is the system to calling lseek in this manner for these functions?  I imagine other platforms are implementing their own versions of lseek and changing this might break them.



----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Atari%20file%20i/o%20functions">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="1285.html">Ullrich von Bassewitz: "[cc65] cc65 runtime module loader (was: 65816)"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1288.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1290.html">Christian Groessler: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1298.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1300.html">Christian Groessler: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1301.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1302.html">Shawn Jefferson: "Re: [cc65] Atari file i/o functions"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2002-04-23 22:09:57 CEST</em>
</em>
</small>
</body>
</html>
