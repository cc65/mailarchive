<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Atari file i/o functions</title>
<meta name="Author" content="Shawn Jefferson (sjefferson_at_sd62.bc.ca)">
<meta name="Subject" content="Re: [cc65] Atari file i/o functions">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Atari file i/o functions</h1>
<!-- received="Tue Apr 23 23:01:48 2002" -->
<!-- isoreceived="20020423210148" -->
<!-- sent="Tue, 23 Apr 2002 14:01:17 -0700" -->
<!-- isosent="20020423210117" -->
<!-- name="Shawn Jefferson" -->
<!-- email="sjefferson_at_sd62.bc.ca" -->
<!-- subject="Re: [cc65] Atari file i/o functions" -->
<!-- id="scc56950.027@gwmail.sd62.bc.ca" -->
<!-- inreplyto="[cc65] Atari file i/o functions" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Shawn Jefferson (<a href="mailto:sjefferson_at_sd62.bc.ca?Subject=Re:%20[cc65]%20Atari%20file%20i/o%20functions"><em>sjefferson_at_sd62.bc.ca</em></a>)<br>
<strong>Date:</strong> 2002-04-23 23:01:17
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Maybe in reply to:</strong> <a href="1286.html">Shawn Jefferson: "[cc65] Atari file i/o functions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1289.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1289.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
&gt;Maybe Christian can answer this in more detail, but as far as I understand 
&gt;the
&gt;sources, lseek is just a dummy function that returns an error code.
&gt;

Yes, that is correct and is also the reason that doing an fseek wasn't working in my program... which I 
was going crazy over until I figured I would look at the library source code!

&gt;Apart from this, the implementation seems to be correct: lseek as defined 
&gt;by
&gt;POSIX returns the current file position as a side effect. This side effect 
&gt;is
&gt;used in ftell(), while fseek() is based on the main function of lseek
&gt;(positioning the file pointer).
&gt;
&gt;The Atari is currently the only system that has a working standard file 
&gt;I/O,
&gt;so if there were changes, they wouldn't break anything. But as it looks for
&gt;me, the current implementation is correct, the only problem is that the 
&gt;(Atari
&gt;specific) lseek function is currently not implemented.

Ok.  We will have to do a bunch of stuff in the lseek function to implement it properly, in assembly... ugh.  The Atari has the fseek and ftell functions built into the DOS, called POINT and NOTE.  We have to call point after working out the offset from whence, call CIO with the command for point and then call CIO again with the command for note to return the file position.  All in assembly... not my forte unfortunately.. I will have to do some quick learning! ;)

In that vein, where is the return value from a function placed?  On the stack?

Is Christian still around?  He coded this stuff in 2000, but didn't code the fseek and ftell functions which really cripples any file i/o you might use.  It is better than what the C64 has now though, so I should count my blessings, I guess!


----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Atari%20file%20i/o%20functions">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="1287.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Maybe in reply to:</strong> <a href="1286.html">Shawn Jefferson: "[cc65] Atari file i/o functions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1289.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<li><strong>Reply:</strong> <a href="1289.html">Ullrich von Bassewitz: "Re: [cc65] Atari file i/o functions"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2002-04-23 23:01:54 CEST</em>
</em>
</small>
</body>
</html>
