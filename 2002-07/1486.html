<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Problem with .define (ca6</title>
<meta name="Author" content="Ullrich von Bassewitz (uz_at_musoftware.de)">
<meta name="Subject" content="Re: [cc65] Problem with .define (ca65)">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Problem with .define (ca65)</h1>
<!-- received="Mon Jul 15 23:37:08 2002" -->
<!-- isoreceived="20020715213708" -->
<!-- sent="Mon, 15 Jul 2002 23:37:16 +0200" -->
<!-- isosent="20020715213716" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz_at_musoftware.de" -->
<!-- subject="Re: [cc65] Problem with .define (ca65)" -->
<!-- id="20020715213716.GB4587@trixie.musoftware.de" -->
<!-- inreplyto="200207151955.g6FJtB725044@xcip2.studcs.uni-sb.de" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Ullrich von Bassewitz (<a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Problem%20with%20.define%20(ca65)"><em>uz_at_musoftware.de</em></a>)<br>
<strong>Date:</strong> 2002-07-15 23:37:16
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="1485.html">Ullrich von Bassewitz: "Re: [cc65] Bug Hunting Odysee"</a>
<li><strong>In reply to:</strong> <a href="1484.html">Stephan Lesch: "[cc65] Problem with .define (ca65)"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
On Mon, Jul 15, 2002 at 09:55:11PM +0200, Stephan Lesch wrote:
&gt; Can anyone find a mistake in the source below? It should
&gt; result in a file with a 1 byte if 'yiff' is defined, and
&gt; a 2 byte otherwise. It works if I define the symbol on the
&gt; command line, but not if it's defined in the source.
&gt; Are the .define and the .ifdef syntactically correct?

They are syntactically correct, but not semantically:-)

.define is not used to define symbols, it is used to define very, very low
level macros. What you did, was creating a macro yiff that expands to nothing.
This is the reason why you got an error at the line with the .ifdef (yiff
expanded to nothing, so the .ifdef was without an argument).

To define symbols, use the equal sign (=). Your code may then look like this:

	foo	= 3

	.ifdef 	foo
		.byte	foo
	.else
		.byte	0
	.endif

While .define has some very rare uses, it is better not to use it at all. Some
time ago, a company paid me for adding some features to ca65, so they could
replace their own assembler with ca65. One of the requests was that it must be
possible to translate most programs written for that older assembler with
ca65. Instead of making ca65 compatible to this old assembler, I decided to
add some meta features that change the way, ca65 works. .define is one of
these features. It defines very low level macros. These macros work on the
token level and will completely ignore scoping. If, for example, you don't
like using '=' to assign values to symbols, you may use

	.define	equ	=

This will replace all 'equ' tokens in the input by '=', so you can write

	foo   	equ	3

The assembler documentation has some more examples. But as I said above,
.define is rather dangerous, so don't use it if you don't have to.

Regards


	Uz


-- 
Ullrich von Bassewitz                                  <a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Problem%20with%20.define%20(ca65)">uz_at_musoftware.de</a>
----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Problem%20with%20.define%20(ca65)">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="1485.html">Ullrich von Bassewitz: "Re: [cc65] Bug Hunting Odysee"</a>
<li><strong>In reply to:</strong> <a href="1484.html">Stephan Lesch: "[cc65] Problem with .define (ca65)"</a>
<!-- nextthread="start" -->
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2002-07-15 23:39:05 CEST</em>
</em>
</small>
</body>
</html>
