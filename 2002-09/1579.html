<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Bank Switching</title>
<meta name="Author" content="Christian Groessler (cpg_at_aladdin.de)">
<meta name="Subject" content="Re: [cc65] Bank Switching">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Bank Switching</h1>
<!-- received="Sat Sep 21 01:23:53 2002" -->
<!-- isoreceived="20020920232353" -->
<!-- sent="21 Sep 2002 01:22:18 +0200" -->
<!-- isosent="20020920232218" -->
<!-- name="Christian Groessler" -->
<!-- email="cpg_at_aladdin.de" -->
<!-- subject="Re: [cc65] Bank Switching" -->
<!-- id="87it105jrp.fsf@power.cnet.aladdin.de" -->
<!-- inreplyto="[cc65] Bank Switching" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Christian Groessler (<a href="mailto:cpg_at_aladdin.de?Subject=Re:%20[cc65]%20Bank%20Switching"><em>cpg_at_aladdin.de</em></a>)<br>
<strong>Date:</strong> 2002-09-21 01:22:18
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="1578.html">Ullrich von Bassewitz: "Re: [cc65] Bank Switching"</a>
<li><strong>Maybe in reply to:</strong> <a href="1566.html">Shawn Jefferson: "[cc65] Bank Switching"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1580.html">Shawn Jefferson: "Re: [cc65] Bank Switching"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
Hi,

On 09/21/2002 12:44:32 AM ZE2 Ullrich von Bassewitz wrote:
&gt;
&gt;As far as I remember, the Atari is able to have separate chunks in an
&gt;executable file, where each chunk has it's own header, and is loaded to a
&gt;different address. The last one of these headers has a special marker. If so,
&gt;the solution would be to slightly modify the standard startup script. Just
&gt;include both headers (place the second header into a segment named HEADER2 or
&gt;similar). Then change the linker config so that each one of the RAM1 and RAM2
&gt;memory areas has its own header.
&gt;
&gt;Maybe one of the Atari guys can comment on this in more detail (or correct me
&gt;if I got this wrong).

You're mostly correct. Mostly, because the last chunk is not in any
way special (as viewed from the EXE file format). The format of an
executable file on the atari is

0xffff      magic number (16bit)
start1      load address of first byte of chunk 1 (16bit)
end1        load address of last byte of chunk 1 (16bit)
block1      contents of chunk, size determined by start1 and end1

            the following is optional and can repeat:

start2      load address of first byte of chunk 2 (16bit)
end2        load address of last byte of chunk 2 (16bit)
block2      contents of chunk, size determined by start2 and end2


In the current atari.cfg linker file, EXEHDR is the first 6 bytes of
the executable (0xffff and the addresses for chunk 1) and AUTOSTRT is
in fact only a 2nd chunk which &quot;loads&quot; the start address of the
program into the relevant system variable.

So with some linker and segments fiddling, one should be able to make
RAM2 a separate chunk in the file. The AUTOSTRT chunk should be last
(unless you know what you do), because I think it's address will be
called immediately after being loaded, before the remaining chunks get
loaded. 

Shawn, if you have problems setting this up, don't hesitate to contact
me, I'm happy to help. (I've never really used this multi-chunk
feature and I'm curious...)

regards,
chris

----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Bank%20Switching">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="1578.html">Ullrich von Bassewitz: "Re: [cc65] Bank Switching"</a>
<li><strong>Maybe in reply to:</strong> <a href="1566.html">Shawn Jefferson: "[cc65] Bank Switching"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="1580.html">Shawn Jefferson: "Re: [cc65] Bank Switching"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2002-09-21 01:24:28 CEST</em>
</em>
</small>
</body>
</html>
