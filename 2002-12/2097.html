<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Another bug?</title>
<meta name="Author" content="Ullrich von Bassewitz (uz_at_musoftware.de)">
<meta name="Subject" content="Re: [cc65] Another bug?">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Another bug?</h1>
<!-- received="Thu Dec 19 14:24:03 2002" -->
<!-- isoreceived="20021219132403" -->
<!-- sent="Thu, 19 Dec 2002 14:24:02 +0100" -->
<!-- isosent="20021219132402" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz_at_musoftware.de" -->
<!-- subject="Re: [cc65] Another bug?" -->
<!-- id="20021219132402.GB27924@trixie.musoftware.de" -->
<!-- inreplyto="se0053f9.019@gwmail.sd62.bc.ca" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Ullrich von Bassewitz (<a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Another%20bug?"><em>uz_at_musoftware.de</em></a>)<br>
<strong>Date:</strong> 2002-12-19 14:24:02
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="2096.html">Ullrich von Bassewitz: "Re: [cc65] 65tris on ATARI"</a>
<li><strong>In reply to:</strong> <a href="2094.html">Shawn Jefferson: "[cc65] Another bug?"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="2118.html">Christian Groessler: "Re: [cc65] Another bug?"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
On Wed, Dec 18, 2002 at 10:54:36AM -0800, Shawn Jefferson wrote:
&gt; Compiling the following code with cc65 2.9.0 for the Atari target and
&gt; running it in SpartaDOS 3.3 causes it to never return control to DOS for some
&gt; reason.

If this is true, it's an atari specific problem. If you have a debugger (maybe
there's one built into the emulator), you can set a breakpoint on _exit. This
label is reached in any case if your program exits regularily (does not
crash). You can then single step through the code and see if the program has
problems in the termination code.

&gt; unsigned char main()

Since code like this has been posted here several times, I would like to add
that this statement generates sub optimal code.

The two function declarations

        void f (void)

and

        void f ()

have a different meaning in C. While the former declares a function that does
not take any parameters, the latter declares a function that may take any
number of parameters (including zero). Since in cc65 compiled code, the called
function pops the parameters (this was choosen because the generated code is
smaller), both function declarations are translated differently, and the
latter one generates more code. So, while it works, you're wasting memory and
the generated code is slower.

As a general rule, if a function does not take any parameters, you should use
&quot;void&quot; as a parameter list.

In case of &quot;main&quot; there are a few additional rules imposed by the C standard.
According to the ISO C standard, the only allowed declarations for main are:

        int main (void);
        int main (int argc, char* argv[]);

Of course, your code will work with cc65, and with a lot of other C compilers,
but at least one should realize that any other declarations of main may cause
problems when porting code to other platforms.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  <a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Another%20bug?">uz_at_musoftware.de</a>
----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Another%20bug?">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="2096.html">Ullrich von Bassewitz: "Re: [cc65] 65tris on ATARI"</a>
<li><strong>In reply to:</strong> <a href="2094.html">Shawn Jefferson: "[cc65] Another bug?"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="2118.html">Christian Groessler: "Re: [cc65] Another bug?"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2002-12-19 14:24:10 CET</em>
</em>
</small>
</body>
</html>
