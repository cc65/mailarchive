<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] c programm</title>
<meta name="Author" content="Stephan Lesch (slesch_at_studcs.uni-sb.de)">
<meta name="Subject" content="Re: [cc65] c programm">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] c programm</h1>
<!-- received="Thu Feb  6 00:24:34 2003" -->
<!-- isoreceived="20030205232434" -->
<!-- sent="Thu, 6 Feb 2003 00:24:31 +0100 (CET)" -->
<!-- isosent="20030205232431" -->
<!-- name="Stephan Lesch" -->
<!-- email="slesch_at_studcs.uni-sb.de" -->
<!-- subject="Re: [cc65] c programm" -->
<!-- id="20030205232754.E96870-100000@xcip5.studcs.uni-sb.de" -->
<!-- inreplyto="3E41736C.CD9F946B@gmx.net" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Stephan Lesch (<a href="mailto:slesch_at_studcs.uni-sb.de?Subject=Re:%20[cc65]%20c%20programm"><em>slesch_at_studcs.uni-sb.de</em></a>)<br>
<strong>Date:</strong> 2003-02-06 00:24:31
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="2411.html">Ullrich von Bassewitz: "Re: [cc65] Another wish: Unsized Arrays in Structures"</a>
<li><strong>In reply to:</strong> <a href="2400.html">3843416: "[cc65] c programm"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="2413.html">Stephan Lesch: "Re: [cc65] c programm"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
typedef struct{
        char color1, color2;
} ROYWINCOL_T;

void  setcharcolors(ROYWINCOL_T *colors);

static ROYWINCOL_T colors = {1,0};

void main(void){
        setcharcolors(&amp;colors);
}

wird compiliert zu:

_colors:
        .byte   $01
        .byte   $00

; ---------------------------------------------------------------
; void main (void)
; ---------------------------------------------------------------

.segment        &quot;CODE&quot;

.proc   _main

.segment        &quot;CODE&quot;

        lda     #&lt;(_colors)
        ldx     #&gt;(_colors)
        jsr     pushax
        jsr     _setcharcolors
        rts

.endproc

Du kannst colors auch lokal in main definieren, dann wird der Code
groesser, weil er einen Zeiger darauf auf dem Stack ablegt und auch
da her holt.

Mit
void  __fastcall__ setcharcolors(ROYWINCOL_T *colors);
wird der Aufruf kuerzer, wenn er in der Funktion den zeiger nicht noch
abspeichern muss:

        lda     #&lt;(_colors)
        ldx     #&gt;(_colors)
        jsr     _setcharcolors
        rts

Wieso man die Struktur nicht direkt im Aufruf angeben kann, a la
setcharcolors(&amp;(ROYWINCOL_T){1,0}) weiss ich nicht. Ich bin nicht sicher,
ob das in C vorgesehen ist...

Gruss,
Stephan


----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20c%20programm">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="2411.html">Ullrich von Bassewitz: "Re: [cc65] Another wish: Unsized Arrays in Structures"</a>
<li><strong>In reply to:</strong> <a href="2400.html">3843416: "[cc65] c programm"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="2413.html">Stephan Lesch: "Re: [cc65] c programm"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-02-06 00:26:30 CET</em>
</em>
</small>
</body>
</html>
