<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] rebuilding libraries - ge</title>
<meta name="Author" content="jimsymolon (jsymolon01_at_attbi.com)">
<meta name="Subject" content="Re: [cc65] rebuilding libraries - generated program crashes">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] rebuilding libraries - generated program crashes</h1>
<!-- received="Thu May 29 15:19:50 2003" -->
<!-- isoreceived="20030529131950" -->
<!-- sent="Thu, 29 May 2003 09:09:15 -0400" -->
<!-- isosent="20030529130915" -->
<!-- name="jimsymolon" -->
<!-- email="jsymolon01_at_attbi.com" -->
<!-- subject="Re: [cc65] rebuilding libraries - generated program crashes" -->
<!-- id="3ED6067B.3060806@attbi.com" -->
<!-- inreplyto="20030529110839.GB26699@trixie.musoftware.de" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> jimsymolon (<a href="mailto:jsymolon01_at_attbi.com?Subject=Re:%20[cc65]%20rebuilding%20libraries%20-%20generated%20program%20crashes"><em>jsymolon01_at_attbi.com</em></a>)<br>
<strong>Date:</strong> 2003-05-29 15:09:15
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3041.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<li><strong>In reply to:</strong> <a href="3041.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3044.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<li><strong>Reply:</strong> <a href="3044.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
Ullrich von Bassewitz wrote:

&gt;On Thu, May 29, 2003 at 06:28:53AM -0400, jimsymolon wrote:
&gt;  
&gt;
&gt;&gt;Right now I don't know where to start.  It is the CFG file for the
&gt;&gt;linker ?  It is one of the programs not getting the right parameters ?
&gt;&gt;    
&gt;&gt;
&gt;
&gt;Unfortunately you haven't given enough information for me to track down the
&gt;problem. Some things you say seem to contradict each other. One example is
&gt;that the EXEHDR segment is added in one situation and not in the other. This
&gt;is almost impossible. Why should the linker do that? Another thing I don't
&gt;understand is: if the non working code is being compiled and used on a Linux
&gt;system, how comes that your compile and link scripts are windows batch files?
&gt;
&gt;If you used the Linux system to just recompile the libraries and the final
&gt;application compile happened on a Windows system, one possible cause is that
&gt;you messed up the libraries/object files or the executable when transfering
&gt;them. Windows has a lot of old and quite illogical behaviours, one being that
&gt;there is a difference between text and binary files. Some tools apply
&gt;automatic conversions to files when transfering them between machines. A
&gt;binary file that gets transferred in text mode will get corrupted when doing
&gt;so.
&gt;
&gt;My suggestion would be to run the binary on the Linux system if you haven't
&gt;done so before. Development under Linux (or other Unices) is a lot easier and
&gt;straightforward than under Windows, and a lot of problems simply don't exist.
&gt;
&gt;If the above is *not* the cause of your problem I need more information about
&gt;what you did *exactly*. Which packages are you using? Which files/tools and
&gt;command lines were used for the original (working) binary and which were use
&gt;for the non working one? On which systems did each step happen and if more
&gt;than one system was involved, how did you transfer the files? Did you compare
&gt;the transfered files resp. output files byte by byte? If so, how do they
&gt;differ? If you didn't: Linux comes out of the box with tools that can do that
&gt;easily. If you're using Windows, things are worse, so see my suggestion above.
&gt;
&gt;Regards
&gt;
&gt;
&gt;        Uz
&gt;
&gt;
&gt;  
&gt;
I'm sorry... lets try again.

I've downloaded the windows binaries and compiled the helloworld example 
program.  I've copied the helloworld program to a DOS3.3 disk and it 
runs on the emulator (apple2win) successfully.  This is done completely 
on a windows machine.  There is a tool called a2tools that will copy a 
binary file into a DOS3.3 file system &quot;disk&quot;.  This disk is then loaded 
into the emulator.

This is using the pre-compiled binaries on the cc65 site.

I want to add in ProDOS support so I downloaded the cc65 sources and 
compiled on the linux box.  Using those binaries, I've recompiled the 
library sources (using the gcc.mak) and re-built the helloworld program 
(cc65 and ld from the shell).  Copying that new program (through samba 
to the windows box and then using a2tools) to DOS3.3 and running in 
applewin - the program crashes.

I'm running samba on the linux box, which provides the file support.

Right now I'm concentrating on building the libraries on linux and 
generating code that will run in the DOS3.3 / apple emulator.  The 
binary built on linux looks correct in the emulator but the function 
calls jump to the wrong place.  For example: the zerobss call,  on both 
binaries (the windows and the linux)  the JSR is to EEB but that 
location is 4 bytes short it should be to EEE.

Its almost like the EXEHDR is messing things up.  It it 4 bytes long.   
 Am I forgetting some type flag somewhere ??

Thanks
Jim




----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20rebuilding%20libraries%20-%20generated%20program%20crashes">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3041.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<li><strong>In reply to:</strong> <a href="3041.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3044.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<li><strong>Reply:</strong> <a href="3044.html">Ullrich von Bassewitz: "Re: [cc65] rebuilding libraries - generated program crashes"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-05-29 15:20:34 CEST</em>
</em>
</small>
</body>
</html>
