<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: [cc65] Restoring vectors (CBM machin</title>
<meta name="Author" content="josef.soucek_at_ct.cz (josef.soucek_at_ct.cz)">
<meta name="Subject" content="[cc65] Restoring vectors (CBM machines)">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>[cc65] Restoring vectors (CBM machines)</h1>
<!-- received="Thu Jun 12 13:34:29 2003" -->
<!-- isoreceived="20030612113429" -->
<!-- sent="Thu, 12 Jun 2003 13:34:22 +0200" -->
<!-- isosent="20030612113422" -->
<!-- name="josef.soucek_at_ct.cz" -->
<!-- email="josef.soucek_at_ct.cz" -->
<!-- subject="[cc65] Restoring vectors (CBM machines)" -->
<!-- id="H00007110dee588a.1055417661.oma.apl.ct.cz@MHS" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> <a href="mailto:josef.soucek_at_ct.cz?Subject=Re:%20[cc65]%20Restoring%20vectors%20(CBM%20machines)"><em>josef.soucek_at_ct.cz</em></a><br>
<strong>Date:</strong> 2003-06-12 13:34:22
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3097.html">Groepaz: "Re: [cc65] Directory/Drive functions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3099.html">Groepaz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3099.html">Groepaz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3100.html">MagerValp: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3103.html">Ullrich von Bassewitz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3107.html">Greg King: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
Hello!
I have one suggestion/note to the 'restoring' subject.
There is a one thing in the cc65 lib which protects the cc65 compiled CBM 
programs to be re-run in the same 'enviroment' after the exit, if the 
common ($8000) cartridge is installed. It is the call of the kernal 
routine &quot;RESTOR&quot; ($FF8A) at the last line of the code in crt0.s, which is 
called just before exiting to BASIC.

On C64 the RESTOR ($FF8A) routine do the following:
Jumps to $FD15 and fills the I/O vector area ($0314-$0333) from the table 
which is present from the $FD30 to $FD4F. The table is also put to the RAM 
area under the ROM ($FD30-$FD4F). Btw. Anybody knows why?

The problem which this solution is that I/O vector area is 'reset' to 
'default', but if there is a cartridge installed which depends on the I/O 
vectors 'redirecting' e.g. IDE64 it is snipped off.

My suggestion is to remove the RESTOR call from crt0.s and 'restore' only 
these vectors which are absolutely necessary.

Best regards,
 Josef Soucek




----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Restoring%20vectors%20(CBM%20machines)">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3097.html">Groepaz: "Re: [cc65] Directory/Drive functions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3099.html">Groepaz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3099.html">Groepaz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3100.html">MagerValp: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3103.html">Ullrich von Bassewitz: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<li><strong>Reply:</strong> <a href="3107.html">Greg King: "Re: [cc65] Restoring vectors (CBM machines)"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-06-12 13:34:51 CEST</em>
</em>
</small>
</body>
</html>
