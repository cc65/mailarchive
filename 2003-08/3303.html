<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] snapshot</title>
<meta name="Author" content="Ullrich von Bassewitz (uz_at_musoftware.de)">
<meta name="Subject" content="Re: [cc65] snapshot">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] snapshot</h1>
<!-- received="Fri Aug 29 11:41:53 2003" -->
<!-- isoreceived="20030829094153" -->
<!-- sent="Fri, 29 Aug 2003 11:41:49 +0200" -->
<!-- isosent="20030829094149" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz_at_musoftware.de" -->
<!-- subject="Re: [cc65] snapshot" -->
<!-- id="20030829094149.GB27608@trixie.musoftware.de" -->
<!-- inreplyto="200308290948.57647.groepaz@gmx.net" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Ullrich von Bassewitz (<a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20snapshot"><em>uz_at_musoftware.de</em></a>)<br>
<strong>Date:</strong> 2003-08-29 11:41:49
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3302.html">Marko Mäkelä: "Re: [cc65] snapshot"</a>
<li><strong>In reply to:</strong> <a href="3301.html">Groepaz: "Re: [cc65] snapshot"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3309.html">Groepaz: "Re: [cc65] snapshot"</a>
<li><strong>Next in thread:</strong> <a href="3287.html">Ullrich von Bassewitz: "Re: [cc65] snapshot"</a>
<li><strong>Reply:</strong> <a href="3309.html">Groepaz: "Re: [cc65] snapshot"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
On Fri, Aug 29, 2003 at 09:48:57AM +0200, Groepaz wrote:
&gt; gives &quot;illegal character constant&quot; for the '\77'
[...]
&gt; '\v' gives &quot;illegal character constant&quot; here

I've fixed both and added a bit more error recovery in case of illegal
character constants. BTW: '\v' is the &quot;vertical tab&quot; character. This seems to
be something, very old terminals had, but this was before my time (so it must
be quite old:-) '\b' is the backspace and this one is still in use today.

&gt; f(i)
&gt; {
&gt; 	i=f()+f();
&gt; }
[...]
&gt; int test(char *s);
&gt;
&gt; test(*s)
&gt; char *s;
&gt; {
&gt; }

While those could be fixed, I don't think it's a good idea, because both
examples show problematic uses, were the source code should get changed, not
the compiler. Old style function decls are deprecated in C99 and will be
removed with the next version of the standard, so my stand is to fix important
things, not obscure features.

In case of the former, I would even say, the code violates the C99 standard
which says in 6.9.1.8:

    If a function that accepts a variable number of arguments is defined
    without a parameter type list that ends with the ellipsis notation, the
    behavior is undefined.

(but then, C99 does also remove &quot;implicit int&quot;, so both function decls would
be invalid according to the new standard).

&gt; the tests that compile still dont work due to some appearent problem in the
&gt; posix directory and/or cbm file i/o stuff.... mpf

If you can give me a few more hints, or a short piece of non working code, I
will try to fix it.

&gt; - functions that return structs seem to translate correctly now (i had to
&gt; disable this before)

C functions still cannot return structs, but assembler functions can if the
size of the struct is one of 1, 2 or 4 (it is returned in the primary
register).

&gt; - even enabling &quot;functions can return structs&quot; doesnt result in an error (?!?)
&gt; does that really have been fixed or is that testsuite playing tricks on me?

The compiler is supposed to issue an error if a C function tries to return a
structure. My own tests show that this is the case, but maybe that the test
suite is somewhat more creative. Can you send me the code that returns a
structure which is accepted by the compiler?

&gt; - several small problems with initializing structs and/or using curly braces
&gt; in a &quot;creative&quot; way seem to be gone

At least there is progress in a few areas :-)

Thanks for doing all the tests!

Regards


        Uz


-- 
Ullrich von Bassewitz                                  <a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20snapshot">uz_at_musoftware.de</a>
----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20snapshot">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3302.html">Marko Mäkelä: "Re: [cc65] snapshot"</a>
<li><strong>In reply to:</strong> <a href="3301.html">Groepaz: "Re: [cc65] snapshot"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3309.html">Groepaz: "Re: [cc65] snapshot"</a>
<li><strong>Next in thread:</strong> <a href="3287.html">Ullrich von Bassewitz: "Re: [cc65] snapshot"</a>
<li><strong>Reply:</strong> <a href="3309.html">Groepaz: "Re: [cc65] snapshot"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-08-29 11:42:09 CEST</em>
</em>
</small>
</body>
</html>
