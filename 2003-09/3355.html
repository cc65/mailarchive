<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-7">
<title>cc65 mailing list archive: Re: [cc65] Optimizing C code</title>
<meta name="Author" content="Shawn Jefferson (sjefferson_at_sd62.bc.ca)">
<meta name="Subject" content="Re: [cc65] Optimizing C code">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Optimizing C code</h1>
<!-- received="Thu Sep  4 23:12:21 2003" -->
<!-- isoreceived="20030904211221" -->
<!-- sent="Thu, 04 Sep 2003 14:09:50 -0700" -->
<!-- isosent="20030904210950" -->
<!-- name="Shawn Jefferson" -->
<!-- email="sjefferson_at_sd62.bc.ca" -->
<!-- subject="Re: [cc65] Optimizing C code" -->
<!-- id="sf5747d3.077@gwmail.sd62.bc.ca" -->
<!-- charset="ISO-8859-7" -->
<!-- inreplyto="[cc65] Optimizing C code" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Shawn Jefferson (<a href="mailto:sjefferson_at_sd62.bc.ca?Subject=Re:%20[cc65]%20Optimizing%20C%20code"><em>sjefferson_at_sd62.bc.ca</em></a>)<br>
<strong>Date:</strong> 2003-09-04 23:09:50
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3354.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<li><strong>Maybe in reply to:</strong> <a href="3327.html">Shawn Jefferson: "[cc65] Optimizing C code"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3357.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<li><strong>Reply:</strong> <a href="3357.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
&gt;What's the problem?
&gt;
&gt;  if (creg != BAKCOL(bmp-&gt;mode)) {              // not background color?
&gt;      bmp-&gt;dat[index] = (bmp-&gt;dat[index] &amp; ~plot4cmask[bit]) |
&gt;                        (creg+1) &lt;&lt; plot4cshift[bit];
&gt;  } else {
&gt;      bmp-&gt;dat[index] = (bmp-&gt;dat[index] &amp; ~plot4cmask[bit]);
&gt;  }
&gt;
&gt;This will generate larger code, but on each code path, the array is addressed
&gt;two times as before. I'm not sure if this will actually generate faster code,
&gt;you will have to look at the assembly to find out.

I wrote a little benchmarking program to tell me which way is faster.  I did as many plots as I could in two minutes and then divided by 2.

Your way (above) gave me 338 pixels per minute, and leaving it the old way gave 345.  Both with the other optimizations mentioned previously (removing the not ~mask, using unsigned ints, etc...) and of course -Osir as well.

Thanks for all the help and information so far!

¯
Shawn


----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Optimizing%20C%20code">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3354.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<li><strong>Maybe in reply to:</strong> <a href="3327.html">Shawn Jefferson: "[cc65] Optimizing C code"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3357.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<li><strong>Reply:</strong> <a href="3357.html">Ullrich von Bassewitz: "Re: [cc65] Optimizing C code"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-09-04 23:12:48 CEST</em>
</em>
</small>
</body>
</html>
