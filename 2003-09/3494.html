<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: [cc65] pcengine port problem...</title>
<meta name="Author" content="Groepaz (groepaz_at_gmx.net)">
<meta name="Subject" content="[cc65] pcengine port problem...">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>[cc65] pcengine port problem...</h1>
<!-- received="Sun Sep 28 02:18:04 2003" -->
<!-- isoreceived="20030928001804" -->
<!-- sent="Sun, 28 Sep 2003 02:13:14 +0200" -->
<!-- isosent="20030928001314" -->
<!-- name="Groepaz" -->
<!-- email="groepaz_at_gmx.net" -->
<!-- subject="[cc65] pcengine port problem..." -->
<!-- id="200309280213.14525.groepaz@gmx.net" -->
<!-- inreplyto="Pine.LNX.4.30.0309280109260.10161-100000@ds9.reckziegel.com" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Groepaz (<a href="mailto:groepaz_at_gmx.net?Subject=Re:%20[cc65]%20pcengine%20port%20problem..."><em>groepaz_at_gmx.net</em></a>)<br>
<strong>Date:</strong> 2003-09-28 02:13:14
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3493.html">Groepaz: "Re: [cc65] drivers..."</a>
<li><strong>In reply to:</strong> <a href="3492.html">Christian Groessler: "Re: [cc65] drivers..."</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3496.html">MagerValp: "Re: [cc65] pcengine port problem..."</a>
<li><strong>Next in thread:</strong> <a href="3490.html">Maciej Witkowiak: "Re: [cc65] drivers..."</a>
<li><strong>Reply:</strong> <a href="3496.html">MagerValp: "Re: [cc65] pcengine port problem..."</a>
<li><strong>Reply:</strong> <a href="3502.html">Ullrich von Bassewitz: "Re: [cc65] pcengine port problem..."</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
tjam, i've looked into my pcengine port again and indeed found the little 
nasty problem that caused the weirdo crashing :=P

i have to explain.... the pcengine uses a (imho very smart) way to do 
bankswitching ... some i/o stuff is mapped over the zeropage, and memory 
vs i/o access is distinguished by the actual opcode used for the access... eg

lda $0001 (3 byte opcode, absolute addressing) accesses the i/o area and
lda $01 (2 byte opcode, zeropage addressing) accesses the memory in zeropage.

this has a drawback however, which is that memory in the zeropage can ONLY be 
accessed by zeropage-addressing, which means that for example the &quot;callax&quot;
function (which uses an indirect jump, using a vector in zeropage) fails 
miserably as it is (there is no indirect jump with zeropage addressing) :=P

now the question is what other library functions may suffer from this problem 
(i am going to create alternative versions for the pcengine port).... its 
easy to grep the source for indirect jumps, but any other memory access (ie 
zeropage access that ends up to be done via 3 byte opcodes) is kindof hard to 
locate :/ (maybe a warning can be added to help locating them?)

gpz

ps: mmh... i dont think thats possible cleanly myself, but if you think 
there's a better solution than providing alternative versions of the runtime 
library stuff, let me know :) - it might become just a little bit worse than 
with the nes though :=P

----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20pcengine%20port%20problem...">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3493.html">Groepaz: "Re: [cc65] drivers..."</a>
<li><strong>In reply to:</strong> <a href="3492.html">Christian Groessler: "Re: [cc65] drivers..."</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3496.html">MagerValp: "Re: [cc65] pcengine port problem..."</a>
<li><strong>Next in thread:</strong> <a href="3490.html">Maciej Witkowiak: "Re: [cc65] drivers..."</a>
<li><strong>Reply:</strong> <a href="3496.html">MagerValp: "Re: [cc65] pcengine port problem..."</a>
<li><strong>Reply:</strong> <a href="3502.html">Ullrich von Bassewitz: "Re: [cc65] pcengine port problem..."</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-09-28 02:18:09 CEST</em>
</em>
</small>
</body>
</html>
