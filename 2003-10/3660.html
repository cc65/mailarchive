<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
<title>cc65 mailing list archive: Re: [cc65] Signed comparisions</title>
<meta name="Author" content="Ullrich von Bassewitz (uz_at_musoftware.de)">
<meta name="Subject" content="Re: [cc65] Signed comparisions">
</head>
<body bgcolor="#FFFFFF" text="#000000">
<h1>Re: [cc65] Signed comparisions</h1>
<!-- received="Mon Oct 27 16:21:50 2003" -->
<!-- isoreceived="20031027152150" -->
<!-- sent="Mon, 27 Oct 2003 16:21:46 +0100" -->
<!-- isosent="20031027152146" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz_at_musoftware.de" -->
<!-- subject="Re: [cc65] Signed comparisions" -->
<!-- id="20031027152146.GA2765@trixie.musoftware.de" -->
<!-- inreplyto="Pine.SOL.4.30.0310271500030.27003-100000@mion.elka.pw.edu.pl" -->
<!-- expires="-1" -->
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<p>
<strong>From:</strong> Ullrich von Bassewitz (<a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Signed%20comparisions"><em>uz_at_musoftware.de</em></a>)<br>
<strong>Date:</strong> 2003-10-27 16:21:46
<p>
<!-- next="start" -->
<ul>
<li><strong>Previous message:</strong> <a href="3659.html">Todd Elliott: "Re: [cc65] DA65 GEOS Disassembly?"</a>
<li><strong>In reply to:</strong> <a href="3658.html">Piotr Fusik: "[cc65] Signed comparisions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3667.html">Piotr Fusik: "Re: [cc65] Signed comparisions"</a>
<li><strong>Reply:</strong> <a href="3667.html">Piotr Fusik: "Re: [cc65] Signed comparisions"</a>
<!-- reply="end" -->
</ul>
<hr noshade><p>
<!-- body="start" -->
<pre>
Hi!

On Mon, Oct 27, 2003 at 03:02:45PM +0100, Piotr Fusik wrote:
&gt; 1. Comparisions against 0 never overflow, so the old code was fine.
&gt; Since comparisions against 0 are quite common, it makes sense
&gt; to support this special case. The difference is especially visible
&gt; for longs.

Ok.

&gt; 2. Signed comparisions can be made unsigned. :-)
[...]
&gt; result2 = (unsigned) (a ^ 0x8000) &lt; (unsigned) (b ^ 0x8000);
&gt; In cases when we didn't use CPX this gives penalty of just one EOR #$80
&gt; comparing with the old incorrect code or unsigned comparisions.

The problem is that the high byte is in X, so it's not only the EOR that is
needed but the value has to moved into A for doing so. And, since A contains
the low byte, it has to be saved somewhere. Which gives a total of five
additional instructions - too much to inline it and probably not worth the
trouble.

There are some more possibilities to improve the code: unsigned compares can
have their own subroutine, which would be faster because it doesn't have to
mess with the V flag.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  <a href="mailto:uz_at_musoftware.de?Subject=Re:%20[cc65]%20Signed%20comparisions">uz_at_musoftware.de</a>
----------------------------------------------------------------------
To unsubscribe from the list send mail to <a href="mailto:majordomo_at_musoftware.de?Subject=Re:%20[cc65]%20Signed%20comparisions">majordomo_at_musoftware.de</a> with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<p><!-- body="end" -->
<hr noshade>
<ul>
<!-- next="start" -->
<li><strong>Previous message:</strong> <a href="3659.html">Todd Elliott: "Re: [cc65] DA65 GEOS Disassembly?"</a>
<li><strong>In reply to:</strong> <a href="3658.html">Piotr Fusik: "[cc65] Signed comparisions"</a>
<!-- nextthread="start" -->
<li><strong>Next in thread:</strong> <a href="3667.html">Piotr Fusik: "Re: [cc65] Signed comparisions"</a>
<li><strong>Reply:</strong> <a href="3667.html">Piotr Fusik: "Re: [cc65] Signed comparisions"</a>
<!-- reply="end" -->
</ul>
<div align="center">
<table border="2" width="100%">
<tr>
<th><a href="date.html">Date view</a></th>
<th><a href="index.html">Thread view</a></th>
<th><a href="subject.html">Subject view</a></th>
</tr>
</table>
</div>
<!-- trailer="footer" -->
<p>
<small>
<em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.3</a> 
: <em>2003-10-27 16:22:04 CET</em>
</em>
</small>
</body>
</html>
