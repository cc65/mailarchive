<?xml version="1.0" encoding="us-ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] Apple2 file io - here: mem</title>
<meta name="Author" content="Ullrich von Bassewitz (uz1musoftware.de)" />
<meta name="Subject" content="Re: [cc65] Apple2 file io - here: memory management questions" />
<meta name="Date" content="2004-07-31" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] Apple2 file io - here: memory management questions</h1>
<!-- received="Sat Jul 31 13:09:40 2004" -->
<!-- isoreceived="20040731110940" -->
<!-- sent="Sat, 31 Jul 2004 13:09:36 +0200" -->
<!-- isosent="20040731110936" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz1musoftware.de" -->
<!-- subject="Re: [cc65] Apple2 file io - here: memory management questions" -->
<!-- id="20040731110936.GA1535@trixie.musoftware.de" -->
<!-- charset="us-ascii" -->
<!-- inreplyto="000101c47610$6b0572d0$0200a8c0&#64;pc" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="4354.html" title="Ullrich von Bassewitz: &quot;Re: [cc65] Apple2 file io - here: memory management questions&quot;">Next message</a> ]
[ <a href="4352.html" title="Oliver Schmidt: &quot;Re: [cc65] Apple2 file io - here: memory management questions&quot;">Previous message</a> ]
[ <a href="4350.html" title="Oliver Schmidt: &quot;Re: [cc65] Apple2 file io - here: memory management questions&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="4356.html" title="Oliver Schmidt: &quot;Re: [cc65] Apple2 file io - here: memory management questions&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Ullrich von Bassewitz &lt;<a href="mailto:uz1musoftware.de?Subject=Re:%20[cc65]%20Apple2%20file%20io%20-%20here:%20memory%20management%20questions">uz1musoftware.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2004-07-31 13:09:36</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>On Fri, Jul 30, 2004 at 12:26:21AM +0200, Oliver Schmidt wrote:
&gt; &#64;Ullrich: Do you see an option to provide some memory allocation mechanism
&gt; suitable for ProDOS 8 file buffers?

It's a common case that aligned memory is needed, so adding such a routine
would also be helpful in other situations. The best way would be to change
malloc to honor an alignment, and create a new malloc wrapper that calls the
old routine with an alignment of 1. However, one problem that prevents a quick
implementation is that the heap routines are highly optimized, with one
routine knowing about the zero page usage of others and similar things, so one
needs to proceed carefully when touching the code.

&gt; 1. scenario: DOS 3.3
[...]
&gt; 2. scenario: DOS 3.3 in upper memory
[...]
&gt; 3. scenario: ProDOS 8 with command interpreter
[...]
&gt; 4. scenario: ProDOS 8 without command interpreter
[...]

I'm not an Apple user, so maybe what I'm saying is stupid, but all this seems
rather complex to me. Why not start with a solution for the most common case
(which seems to be DOS 3.3), and first get something working? Having something
that works with all operating systems in all memory configurations on all
hardware is nice, but it has a high chance to get never implemented. It is my
experience that - having a small but working solution - it is easier to
determine what is needed in addition, and what could be left of or changed.

Please note that I'm not critizing your explanations. They are elaborated and
very understandable. But when I read it, my thoughts were &quot;do we really need
to consider all this for a first working solution?&quot;.

I remember all the discussions about file I/O for the CBMs. I had refused to
implement file I/O for the CBMs because I thought that would be a nice user
contribution. As a result, I had endless discussions, both on and off list
about how this could be done. People came with ideas how to support fast
loaders, virtual file systems, all sorts of non standard addon hardware and
whatever. I'm sure I spent more than 25 hours just discussing file system
concepts and explaining the existing API in the cc65 libs. Plus, there were
regular mails from people complaining that printf (&quot;Hello world&quot;) did not
work. At one point I was so fed up that I just added file I/O. While it is not
perfect (no fast loader, no special devices, not interrupt safe, ...) it works
reasonably well, and discussions about CBM file i/o have more or less
vanished.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  uz&#64;musoftware&#46;<!--nospam-->de
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Sat Jul 31 13:09:40 2004</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="4354.html" title="Next message in the list">Ullrich von Bassewitz: "Re: [cc65] Apple2 file io - here: memory management questions"</a></li>
<li><dfn>Previous message</dfn>: <a href="4352.html" title="Previous message in the list">Oliver Schmidt: "Re: [cc65] Apple2 file io - here: memory management questions"</a></li>
<li><dfn>In reply to</dfn>: <a href="4350.html" title="Message to which this message replies">Oliver Schmidt: "Re: [cc65] Apple2 file io - here: memory management questions"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="4356.html" title="Next message in this discussion thread">Oliver Schmidt: "Re: [cc65] Apple2 file io - here: memory management questions"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="4356.html" title="Message sent in reply to this message">Oliver Schmidt: "Re: [cc65] Apple2 file io - here: memory management questions"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#4353" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#4353" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#4353" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2004-07-31 13:09:49 CEST
</em></small></p>
</body>
</html>
