<?xml version="1.0" encoding="us-ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: [cc65] Changed semantics of callirq a</title>
<meta name="Author" content="Ullrich von Bassewitz (uz1musoftware.de)" />
<meta name="Subject" content="[cc65] Changed semantics of callirq and interruptors" />
<meta name="Date" content="2005-04-25" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>[cc65] Changed semantics of callirq and interruptors</h1>
<!-- received="Mon Apr 25 22:27:59 2005" -->
<!-- isoreceived="20050425202759" -->
<!-- sent="Mon, 25 Apr 2005 22:27:46 +0200" -->
<!-- isosent="20050425202746" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz1musoftware.de" -->
<!-- subject="[cc65] Changed semantics of callirq and interruptors" -->
<!-- id="20050425202746.GA19385@trixie.musoftware.de" -->
<!-- charset="us-ascii" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="4943.html" title="Oliver Schmidt: &quot;Re: [cc65] Changed semantics of callirq and interruptors&quot;">Next message</a> ]
[ <a href="4941.html" title="Ullrich von Bassewitz: &quot;Re: [cc65] Possible install.vbs bug&quot;">Previous message</a> ]
<!-- unextthread="start" -->
 [ <a href="4943.html" title="Oliver Schmidt: &quot;Re: [cc65] Changed semantics of callirq and interruptors&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Ullrich von Bassewitz &lt;<a href="mailto:uz1musoftware.de?Subject=Re:%20[cc65]%20Changed%20semantics%20of%20callirq%20and%20interruptors">uz1musoftware.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2005-04-25 22:27:46</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>After some discussion with Oliver Schmidt, who works on the Apple ][
implementation, I've decided to change the semantics of interruptors when used
together with callirq, the standard routine that calls all interruptors in a
program. An interruptor must now return with carry set if the interrupt was
handled, and carry clear if not. &quot;Handled&quot; means that the interrupt source is
no longer active. callirq will stop calling interruptors after the first call
to one that claims to have handled the interrupt.

Since the interrupt entries of all loadable drivers are called via an
interruptor in the wrapper code, above is also true for the IRQ entries in the
drivers. Existing drivers have already been changed.

On most platforms, the standard IRQ is just used as a timer. If your
interruptor does nothing with the interrupt source, but just uses the
interrupt to do some background tasks, just add a clc instruction to existing
code, and you're set. Code that does things like serial interrupts needs a sec
instruction if the interrupt has been handled.

Since .interruptor together with a linker config does nothing but generate a
table with handler addresses, above changes do mean nothing if you aren't also
using the callirq routine which comes with the C library.

I'm not sure if this will have an impact on Contiki somehow. If you're a
Contiki developer, please check the code.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  uz&#64;musoftware&#46;<!--nospam-->de
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Mon Apr 25 22:27:59 2005</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="4943.html" title="Next message in the list">Oliver Schmidt: "Re: [cc65] Changed semantics of callirq and interruptors"</a></li>
<li><dfn>Previous message</dfn>: <a href="4941.html" title="Previous message in the list">Ullrich von Bassewitz: "Re: [cc65] Possible install.vbs bug"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="4943.html" title="Next message in this discussion thread">Oliver Schmidt: "Re: [cc65] Changed semantics of callirq and interruptors"</a></li>
<li><a name="replies" id="replies"></a><dfn>Maybe reply</dfn>:  <a href="4943.html" title="Message sent in reply to this message">Oliver Schmidt: "Re: [cc65] Changed semantics of callirq and interruptors"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#4942" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#4942" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#4942" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2005-04-25 22:28:02 CEST
</em></small></p>
</body>
</html>
