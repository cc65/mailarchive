<?xml version="1.0" encoding="us-ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] CC65 and Stack Pointer</title>
<meta name="Author" content="Ullrich von Bassewitz (uz1musoftware.de)" />
<meta name="Subject" content="Re: [cc65] CC65 and Stack Pointer" />
<meta name="Date" content="2006-11-29" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] CC65 and Stack Pointer</h1>
<!-- received="Wed Nov 29 08:52:34 2006" -->
<!-- isoreceived="20061129075234" -->
<!-- sent="Wed, 29 Nov 2006 08:52:28 +0100" -->
<!-- isosent="20061129075228" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz1musoftware.de" -->
<!-- subject="Re: [cc65] CC65 and Stack Pointer" -->
<!-- id="20061129075228.GA2223@trixie.musoftware.de" -->
<!-- charset="us-ascii" -->
<!-- inreplyto="456CF3D7.4020603&#64;asahi-net.or.jp" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="../2006-12/5621.html" title="TXG/MNX: &quot;[cc65] From me to all&quot;">Next message</a> ]
[ <a href="5619.html" title="Mark J. Reed: &quot;Re: [cc65] CC65 and Stack Pointer&quot;">Previous message</a> ]
[ <a href="5617.html" title="Hiroji Kimura: &quot;Re: [cc65] CC65 and Stack Pointer&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="../2006-12/5621.html" title="TXG/MNX: &quot;[cc65] From me to all&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Ullrich von Bassewitz &lt;<a href="mailto:uz1musoftware.de?Subject=Re:%20[cc65]%20CC65%20and%20Stack%20Pointer">uz1musoftware.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2006-11-29 08:52:28</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>Good morning.

On Wed, Nov 29, 2006 at 11:43:35AM +0900, Hiroji Kimura wrote:
&gt; oz,
&gt;
&gt; Thank you for your quick reply. I really appreciate it.
&gt;
&gt; &gt; 3. Upon entering the interrupt handler do we need to push registers
&gt; and pop them before RTI?
&gt;
&gt; &gt;If you're calling C code, you will also have to save the zero page
&gt; &gt;locations used by the compiler. If your interrupt handler doesn't use
&gt; C &gt;code, saving just the registers is ok.
&gt;
&gt; What locations in the zero page does CC65 use?  Could you tell me which
&gt; document has that information?

Any space in the ZEROPAGE segment. See the linker config and the zeropage.s
module on how big it is and where it is located.

&gt; Also I wonder why our calculator works
&gt; even without saving registers and zero page locations.  We are calling a
&gt; c function within an interrupt and I am pretty sure that it will use
&gt; real 6502 registers. I guess we only have &quot;while(1);&quot; in our main function.

Probably. If your main function doesn't do any actual calculations, there's
nothing that can be destroyed in an interrupt.

&gt; Now, I am just curios. Why does cc65 generate codes which depend on
&gt; subroutines like pushax and the secondary stack?  I understand Small-c
&gt; implementation assumes a primary and a secondary registers.  I guess the
&gt; reason is to make porting the c compiler to different architectures
&gt; easier. Is it one of the reasons?

The main reason is that the 6502 doesn't have many registers, all of them are
just 8 bit and specialized. So it is for example impossible to do a
int=int+int calculation just by using registers. The solution is to keep the
values in main storage. This is why cc65 uses the software stack. And since
the code to push and pop values onto this stack is rather large, subroutines
are used.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  uz&#64;musoftware&#46;<!--nospam-->de
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Wed Nov 29 08:52:34 2006</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="../2006-12/5621.html" title="Next message in the list">TXG/MNX: "[cc65] From me to all"</a></li>
<li><dfn>Previous message</dfn>: <a href="5619.html" title="Previous message in the list">Mark J. Reed: "Re: [cc65] CC65 and Stack Pointer"</a></li>
<li><dfn>In reply to</dfn>: <a href="5617.html" title="Message to which this message replies">Hiroji Kimura: "Re: [cc65] CC65 and Stack Pointer"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="../2006-12/5621.html" title="Next message in this discussion thread">TXG/MNX: "[cc65] From me to all"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="../2006-12/5621.html" title="Message sent in reply to this message">TXG/MNX: "[cc65] From me to all"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#5620" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#5620" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#5620" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2006-11-29 08:52:37 CET
</em></small></p>
</body>
</html>
