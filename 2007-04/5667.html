<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: RE: [cc65] Atari Library dosdetect.s</title>
<meta name="Author" content="Christian Groessler (chris1groessler.org)" />
<meta name="Subject" content="RE: [cc65] Atari Library dosdetect.s" />
<meta name="Date" content="2007-04-02" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>RE: [cc65] Atari Library dosdetect.s</h1>
<!-- received="Mon Apr  2 00:22:17 2007" -->
<!-- isoreceived="20070401222217" -->
<!-- sent="Mon, 2 Apr 2007 00:22:03 +0200 (CEST)" -->
<!-- isosent="20070401222203" -->
<!-- name="Christian Groessler" -->
<!-- email="chris1groessler.org" -->
<!-- subject="RE: [cc65] Atari Library dosdetect.s" -->
<!-- id="Pine.NEB.4.64.0704020003280.12721@strommasten.groessler.org" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="000a01c771b4$c41fd160$fade4418&#64;ORANGE2" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="5668.html" title="Shawn Jefferson: &quot;RE: [cc65] Atari Library dosdetect.s&quot;">Next message</a> ]
[ <a href="../2007-03/5666.html" title="Oliver Schmidt: &quot;Re: [cc65] Idea for CC65 programmers&quot;">Previous message</a> ]
[ <a href="../2007-03/5664.html" title="Shawn Jefferson: &quot;RE: [cc65] Atari Library dosdetect.s&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="5668.html" title="Shawn Jefferson: &quot;RE: [cc65] Atari Library dosdetect.s&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Christian Groessler &lt;<a href="mailto:chris1groessler.org?Subject=RE:%20[cc65]%20Atari%20Library%20dosdetect.s">chris1groessler.org</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2007-04-02 00:22:03</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>On Wed, 28 Mar 2007, Shawn Jefferson wrote:

&gt; Christian said:
&gt; 
&gt; &gt;Yes, that's not really nice. But what is the exact problem if ATARIDOS is 
&gt; &gt;detected?
&gt; 
&gt; I want to exit differently based on whether or not NODOS has been detected.
&gt; I actually thought it was working, but then had to look at the source code
&gt; after realizing my if(_dos_type == NODOS) code was never reached.  For
&gt; instance, in situations where no DOS was loaded, you cannot rts from your
&gt; program and you need to make other arrangements, such as jmp $E477.

Point taken.


&gt; If you don't think these changes are useful, then I can always look at $703
&gt; myself, rather than looking at _dos_type.  If that's the case, maybe the
&gt; NODOS define can be removed from atari.h too.  I realize that since this
&gt; code is in the runtime and always linked to an Atari project, you may not
&gt; want to introduce more code than is strictly necessary.

The Atari runtime is already the largest of all cc65 platforms, I think.
And the best way IMO to detect NODOS would be to scan the driver table 
(HATABS) for an entry for the &quot;D&quot; device. Which would add even more bytes.


&gt; Perhaps a larger function, not part of the runtime, is needed to correctly
&gt; detect all the various versions of DOS and people can then link that in if
&gt; they want to detect those.  I've got a fairly large list of the contents of
&gt; $700-70E from various DOSes that might help in that regard.

I think this is a good idea. The _dos_type variable then only detects 
DOSes which the runtime needs to distinguish in order to work correctly 
and support all options, and the new function could give more detailed 
information about other/no DOSes. In this case the NODOS define could be 
in fact removed, in order not to confuse people in the future. The 
new function could be part of the runtime, but not in that part which 
unconditionally gets loaded.

Could you send me your list of $700-$70E contents?

chris
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Mon Apr  2 00:22:17 2007</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="5668.html" title="Next message in the list">Shawn Jefferson: "RE: [cc65] Atari Library dosdetect.s"</a></li>
<li><dfn>Previous message</dfn>: <a href="../2007-03/5666.html" title="Previous message in the list">Oliver Schmidt: "Re: [cc65] Idea for CC65 programmers"</a></li>
<li><dfn>In reply to</dfn>: <a href="../2007-03/5664.html" title="Message to which this message replies">Shawn Jefferson: "RE: [cc65] Atari Library dosdetect.s"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="5668.html" title="Next message in this discussion thread">Shawn Jefferson: "RE: [cc65] Atari Library dosdetect.s"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="5668.html" title="Message sent in reply to this message">Shawn Jefferson: "RE: [cc65] Atari Library dosdetect.s"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#5667" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#5667" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#5667" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2007-04-02 00:22:21 CEST
</em></small></p>
</body>
</html>
