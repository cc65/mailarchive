<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] why this doesn't work?</title>
<meta name="Author" content="Ullrich von Bassewitz (uz1musoftware.de)" />
<meta name="Subject" content="Re: [cc65] why this doesn't work?" />
<meta name="Date" content="2010-06-06" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] why this doesn't work?</h1>
<!-- received="Sun Jun  6 13:40:10 2010" -->
<!-- isoreceived="20100606114010" -->
<!-- sent="Sun, 6 Jun 2010 13:40:01 +0200" -->
<!-- isosent="20100606114001" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz1musoftware.de" -->
<!-- subject="Re: [cc65] why this doesn't work?" -->
<!-- id="20100606114001.GA5526@trixie.musoftware.de" -->
<!-- charset="utf-8" -->
<!-- inreplyto="AANLkTikM3IVo3h54oL1QE38CCadHVHGgPPu9qT24n3V-&#64;mail.gmail.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="8467.html" title="Steve Davison: &quot;Re: [cc65] why this doesn't work?&quot;">Next message</a> ]
[ <a href="8465.html" title="Mark J. Reed: &quot;Re: [cc65] why this doesn't work?&quot;">Previous message</a> ]
[ <a href="8464.html" title="S M: &quot;[cc65] why this doesn't work?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="8467.html" title="Steve Davison: &quot;Re: [cc65] why this doesn't work?&quot;">Next in thread</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Ullrich von Bassewitz &lt;<a href="mailto:uz1musoftware.de?Subject=Re:%20[cc65]%20why%20this%20doesn't%20work?">uz1musoftware.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2010-06-06 13:40:01</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>On Sun, Jun 06, 2010 at 11:16:37AM +0100, S M wrote:
&gt; &gt; if ( moviles [i].tipo &gt; -1 )
&gt;
&gt; Member tipo is of type char, the current values for tipo are 0,1,2 and 255.
&gt; But this condition never evaluates to true even when assessing 0,1 or 2. I
&gt; made it work with
&gt;
&gt; if ( moviles [i].tipo &gt;= 0 )
&gt;
&gt; but why doesn't it work as it is above, it would produce better code I
&gt; presume.

What you're doing is doubtful, but the compiler is in fact wrong here.

Characters are unsigned, and the compiler tries to do the comparison using
unsigned chars and finds out that an unsigned char can never be greater than
-1 casted to unsigned char (which is 0xFF). The standard says that default
integer promotions have to be applied, so the comparison must use ints, which
means that your code is valid and should work. But - and this is the doubtful
part - it will always be true, since something stored in an unsigned char is
never negative. So your code is actually a do-nothing operation.

As a general rule, don't use negative numbers if you don't have to, because
the 6502 needs additional code in many case to handle them. I do assume that
your assumption about better code when using negative numbers is not backed by
any facts. At least I can hardly imagine how this could be the case.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  uz&#64;musoftware&#46;<!--nospam-->de
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Sun Jun  6 13:40:10 2010</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="8467.html" title="Next message in the list">Steve Davison: "Re: [cc65] why this doesn't work?"</a></li>
<li><dfn>Previous message</dfn>: <a href="8465.html" title="Previous message in the list">Mark J. Reed: "Re: [cc65] why this doesn't work?"</a></li>
<li><dfn>In reply to</dfn>: <a href="8464.html" title="Message to which this message replies">S M: "[cc65] why this doesn't work?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="8467.html" title="Next message in this discussion thread">Steve Davison: "Re: [cc65] why this doesn't work?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#8466" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#8466" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#8466" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2010-06-06 13:40:13 CEST
</em></small></p>
</body>
</html>
