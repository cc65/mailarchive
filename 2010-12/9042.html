<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] How to force a read from a</title>
<meta name="Author" content="Oliver Schmidt (ol.sc1web.de)" />
<meta name="Subject" content="Re: [cc65] How to force a read from a memory mapped register w/o volatile" />
<meta name="Date" content="2010-12-06" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] How to force a read from a memory mapped register w/o volatile</h1>
<!-- received="Mon Dec  6 13:09:16 2010" -->
<!-- isoreceived="20101206120916" -->
<!-- sent="Mon, 6 Dec 2010 13:09:10 +0100" -->
<!-- isosent="20101206120910" -->
<!-- name="Oliver Schmidt" -->
<!-- email="ol.sc1web.de" -->
<!-- subject="Re: [cc65] How to force a read from a memory mapped register w/o volatile" -->
<!-- id="AANLkTik3s3DRJQpeOx=kY8OB-ke6Ya7b1EKhAJt-up6h@mail.gmail.com" -->
<!-- charset="ISO-8859-1" -->
<!-- inreplyto="AANLkTinwYc-Qm0Spfg2POxxoyNG87bXJLJ4K4qM8eQ0s&#64;mail.gmail.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="9043.html" title="Dave Dribin: &quot;Re: [cc65] How to force a read from a memory mapped register w/o volatile&quot;">Next message</a> ]
[ <a href="9041.html" title="thefox xofeht: &quot;Re: [cc65] How to force a read from a memory mapped register w/o volatile&quot;">Previous message</a> ]
[ <a href="9040.html" title="Dave Dribin: &quot;[cc65] How to force a read from a memory mapped register w/o volatile&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="9044.html" title="Dave Dribin: &quot;Re: [cc65] How to force a read from a memory mapped register w/o volatile&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Oliver Schmidt &lt;<a href="mailto:ol.sc1web.de?Subject=Re:%20[cc65]%20How%20to%20force%20a%20read%20from%20a%20memory%20mapped%20register%20w/o%20volatile">ol.sc1web.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2010-12-06 13:09:10</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>Hi Dave,

&gt; {
&gt;   IO_Read8(0x2002);
&gt;   IO_Write8(0x2006, 0x20);
&gt;   IO_Write8(0x2006, 0x00);
&gt; }

&gt; Unfortunately, the IO_Read8() is being optimized out when compiled with -Os:

&gt; Typically the 'volatile' keyword tells the compiler not to perform
&gt; this optimization.

I don't agree at all. The 'volatile' keyword tells the compiler not to
cache values read but to rather presume they might have beeen changed
at any time (by other threads, ISRs, MM I/O, ...). The 'volatile'
keyword does *not* tell the compiler that any read/write may have side
effects necessary and therefore needs to be performed always.

Regards,
Oliver
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Mon Dec  6 13:09:16 2010</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="9043.html" title="Next message in the list">Dave Dribin: "Re: [cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<li><dfn>Previous message</dfn>: <a href="9041.html" title="Previous message in the list">thefox xofeht: "Re: [cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<li><dfn>In reply to</dfn>: <a href="9040.html" title="Message to which this message replies">Dave Dribin: "[cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="9044.html" title="Next message in this discussion thread">Dave Dribin: "Re: [cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="9044.html" title="Message sent in reply to this message">Dave Dribin: "Re: [cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<li><dfn>Reply</dfn>:  <a href="9052.html" title="Message sent in reply to this message">Ullrich von Bassewitz: "Re: [cc65] How to force a read from a memory mapped register w/o volatile"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#9042" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#9042" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#9042" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2010-12-06 13:09:18 CET
</em></small></p>
</body>
</html>
