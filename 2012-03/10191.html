<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] Why crashing attempting to</title>
<meta name="Author" content="Payton Byrd (plbyrd1gmail.com)" />
<meta name="Subject" content="Re: [cc65] Why crashing attempting to free this struct?" />
<meta name="Date" content="2012-03-26" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] Why crashing attempting to free this struct?</h1>
<!-- received="Mon Mar 26 20:32:19 2012" -->
<!-- isoreceived="20120326183219" -->
<!-- sent="Mon, 26 Mar 2012 13:31:48 -0500" -->
<!-- isosent="20120326183148" -->
<!-- name="Payton Byrd" -->
<!-- email="plbyrd1gmail.com" -->
<!-- subject="Re: [cc65] Why crashing attempting to free this struct?" -->
<!-- id="CAJm6qqef+rsz445LqJs-3h2rxkLy8A3czhbrior+SMXc4C_GvQ@mail.gmail.com" -->
<!-- charset="ISO-8859-1" -->
<!-- inreplyto="CAJm6qqf9Ur8cupKyK6F_gBh73zyPGGVCA0nQoiYxtJgvU8miOw&#64;mail.gmail.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="10192.html" title="Joseph Rose: &quot;Re: [cc65] Possible bug in cc65&quot;">Next message</a> ]
[ <a href="10190.html" title="thefox xofeht: &quot;Re: [cc65] Possible bug in cc65&quot;">Previous message</a> ]
[ <a href="10170.html" title="Payton Byrd: &quot;Re: [cc65] Why crashing attempting to free this struct?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="10193.html" title="Ullrich von Bassewitz: &quot;Re: [cc65] Why crashing attempting to free this struct?&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Payton Byrd &lt;<a href="mailto:plbyrd1gmail.com?Subject=Re:%20[cc65]%20Why%20crashing%20attempting%20to%20free%20this%20struct?">plbyrd1gmail.com</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2012-03-26 20:31:48</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>On Sat, Mar 24, 2012 at 8:09 PM, Payton Byrd &lt;plbyrd&#64;gmail&#46;<!--nospam-->com&gt; wrote:

&gt;
&gt;
&gt; On Sat, Mar 24, 2012 at 8:07 PM, Christopher Pow &lt;
&gt; christopher.s.pow&#64;gmail&#46;<!--nospam-->com&gt; wrote:
&gt;
&gt;&gt; &gt; I get a CPU jam whenever I attempt to free an instance of
&gt;&gt; &gt; DirectoryListReuBlock.  I've got no idea what's causing this, but they
&gt;&gt; have
&gt;&gt; &gt; to be freed or I'll have memory leaks galore.
&gt;&gt;
&gt;&gt; Probably would have to see more of the code to be able to help...
&gt;&gt;
&gt;
&gt; Here's the code for instantiating an instance of the struct:
&gt;
&gt;
&gt; directory_list_reu_block_t * constructDirectoryListReuBlock()
&gt; {
&gt; 	directory_list_reu_block_t *result = (directory_list_reu_block_t *)malloc(sizeof(directory_list_reu_block_t));
&gt;
&gt;
&gt;
&gt; 	//log(&quot;Constructing Directory List REU Block.&quot;);
&gt; 	result-&gt;block = 0;
&gt; 	result-&gt;next = 0;
&gt; 	result-&gt;previous = 0;
&gt; 	memset(result-&gt;nodes[0].cbmDirectoryEntry.name, 0, 17);
&gt;
&gt;
&gt; 	memset(result-&gt;nodes[1].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[2].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[3].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[4].cbmDirectoryEntry.name, 0, 17);
&gt;
&gt;
&gt; 	memset(result-&gt;nodes[5].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[6].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[7].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[8].cbmDirectoryEntry.name, 0, 17);
&gt;
&gt;
&gt; 	memset(result-&gt;nodes[9].cbmDirectoryEntry.name, 0, 17);
&gt; 	memset(result-&gt;nodes[0].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[1].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[2].screenCodesName, 32, 17);
&gt;
&gt;
&gt; 	memset(result-&gt;nodes[3].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[4].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[5].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[6].screenCodesName, 32, 17);
&gt;
&gt;
&gt; 	memset(result-&gt;nodes[7].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[8].screenCodesName, 32, 17);
&gt; 	memset(result-&gt;nodes[9].screenCodesName, 32, 17);
&gt; 	//log(&quot;Constructed Directory List REU Block.&quot;);
&gt;
&gt; }
&gt;
&gt;
Found and fixed the problem in the above code.  There is no return
statement in this function, so the return value was random memory locations
 which meant code was getting overwritten.  Is there not supposed to be a
warning or error generated in such a scenario?

----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Mon Mar 26 20:32:19 2012</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="10192.html" title="Next message in the list">Joseph Rose: "Re: [cc65] Possible bug in cc65"</a></li>
<li><dfn>Previous message</dfn>: <a href="10190.html" title="Previous message in the list">thefox xofeht: "Re: [cc65] Possible bug in cc65"</a></li>
<li><dfn>In reply to</dfn>: <a href="10170.html" title="Message to which this message replies">Payton Byrd: "Re: [cc65] Why crashing attempting to free this struct?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="10193.html" title="Next message in this discussion thread">Ullrich von Bassewitz: "Re: [cc65] Why crashing attempting to free this struct?"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="10193.html" title="Message sent in reply to this message">Ullrich von Bassewitz: "Re: [cc65] Why crashing attempting to free this struct?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#10191" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#10191" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#10191" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2012-03-26 20:32:22 CEST
</em></small></p>
</body>
</html>
