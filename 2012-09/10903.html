<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] Re: readdir bug</title>
<meta name="Author" content="Oliver Schmidt (ol.sc1web.de)" />
<meta name="Subject" content="Re: [cc65] Re: readdir bug" />
<meta name="Date" content="2012-09-30" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] Re: readdir bug</h1>
<!-- received="Sun Sep 30 17:10:48 2012" -->
<!-- isoreceived="20120930151048" -->
<!-- sent="Sun, 30 Sep 2012 17:10:39 +0200" -->
<!-- isosent="20120930151039" -->
<!-- name="Oliver Schmidt" -->
<!-- email="ol.sc1web.de" -->
<!-- subject="Re: [cc65] Re: readdir bug" -->
<!-- id="CACT=u70j88jOP8QJV62rizLfKP5S6zUNWhUe7LBPBxkA0fkn+A@mail.gmail.com" -->
<!-- charset="ISO-8859-1" -->
<!-- inreplyto="5EBC07BDA8D7485C86D1D405FAA7C7F5&#64;ORANGE2" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="../2012-10/10904.html" title="Oliver Schmidt: &quot;[cc65] dio_query_sectcount() on Atari ?&quot;">Next message</a> ]
[ <a href="10902.html" title="Spiro Trikaliotis: &quot;Re: Cursory analyses of CBM readdir bug (was: [cc65] Re: readdir bug)&quot;">Previous message</a> ]
[ <a href="10900.html" title="Shawn Jefferson: &quot;RE: [cc65] Re: readdir bug&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="10864.html" title="Oliver Schmidt: &quot;Re: [cc65] Re: readdir bug&quot;">Next in thread</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Oliver Schmidt &lt;<a href="mailto:ol.sc1web.de?Subject=Re:%20[cc65]%20Re:%20readdir%20bug">ol.sc1web.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2012-09-30 17:10:39</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>Hi,

Somehow I must have missed this section in the readdir() doc ;-))

&quot;On several platforms, namely the CBMs and the Atari, the disk drives
get confused when opening/closing files between directory reads. So
for example a program that reads the list of files on a disk, and
after each call to readdir, opens the file to process it, will fail.
Possible solutions are reading the directory into memory before
processing the file list, or to reset the directory by seeking to the
correct position after opening/closing a file:
        seekdir (DIR, telldir (DIR));
Platforms known to work without problems are: Apple.&quot;

However now that I read the docs I adjusted the multidemo sample
accordingly. I verified that it runs on the C64, the Apple II, the
Atari and the C128.

Some notes on the C128:
- So far there was no overlay linker config. I added one.
- Roughly half of the C128 extended memory drivers don't work with the
multidemo sample :-(

Here's the output of a typical multidemo session on the C64:
Dbg: Loading overlay 4 from file
Log: Loading extended memory driver
Dbg: Searching for emdrivers
Dbg: Skipping file multdemo
Dbg: Skipping file multdemo.1
Dbg: Skipping file multdemo.2
Dbg: Skipping file multdemo.3
Dbg: Skipping file multdemo.4
Dbg: Memorizing file c64-georam.emd
Dbg: Memorizing file c64-reu.emd
Dbg: Memorizing file c64-ramcart.emd
Dbg: Memorizing file c64-c256k.emd
Dbg: Memorizing file c64-dqbb.emd
Dbg: Memorizing file c64-ram.emd
Dbg: Trying emdriver c64-georam.emd
Dbg: Loaded emdriver c64-georam.emd
Log: Copying overlays into ext. memory
Dbg: Reading overlay file multdemo.1
Dbg: Stored overlay 1 in pages 0-0
Dbg: Reading overlay file multdemo.2
Dbg: Stored overlay 2 in pages 1-1
Dbg: Reading overlay file multdemo.3
Dbg: Stored overlay 3 in pages 2-2
Log: Press any key...
Dbg: Loading overlay 1 from memory
Log: Calling overlay 1 from main
Log: Calling main from overlay 1
Dbg: Loading overlay 2 from memory
Log: Calling overlay 2 from main
Log: Calling main from overlay 2
Dbg: Loading overlay 3 from memory
Log: Calling overlay 3 from main
Log: Calling main from overlay 3
Log: Press any key...

Regards,
Oliver
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Sun Sep 30 17:10:48 2012</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="../2012-10/10904.html" title="Next message in the list">Oliver Schmidt: "[cc65] dio_query_sectcount() on Atari ?"</a></li>
<li><dfn>Previous message</dfn>: <a href="10902.html" title="Previous message in the list">Spiro Trikaliotis: "Re: Cursory analyses of CBM readdir bug (was: [cc65] Re: readdir bug)"</a></li>
<li><dfn>In reply to</dfn>: <a href="10900.html" title="Message to which this message replies">Shawn Jefferson: "RE: [cc65] Re: readdir bug"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="10864.html" title="Next message in this discussion thread">Oliver Schmidt: "Re: [cc65] Re: readdir bug"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#10903" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#10903" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#10903" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2012-09-30 17:10:52 CEST
</em></small></p>
</body>
</html>
