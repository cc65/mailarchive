<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] dio_query_sectcount() on A</title>
<meta name="Author" content="Oliver Schmidt (ol.sc1web.de)" />
<meta name="Subject" content="Re: [cc65] dio_query_sectcount() on Atari ?" />
<meta name="Date" content="2012-10-19" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] dio_query_sectcount() on Atari ?</h1>
<!-- received="Fri Oct 19 16:30:51 2012" -->
<!-- isoreceived="20121019143051" -->
<!-- sent="Fri, 19 Oct 2012 16:29:38 +0200" -->
<!-- isosent="20121019142938" -->
<!-- name="Oliver Schmidt" -->
<!-- email="ol.sc1web.de" -->
<!-- subject="Re: [cc65] dio_query_sectcount() on Atari ?" -->
<!-- id="CACT=u71ewB29G39i199=d378GvhU2pFZQ+38_tu1=Yp984DCEQ@mail.gmail.com" -->
<!-- charset="ISO-8859-1" -->
<!-- inreplyto="550F28036F6F44698B345234CB5D4A4D&#64;ORANGE2" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="10935.html" title="silverdr1wfmh.org.pl: &quot;Re: [cc65] Goodbye _curunit, Hello chdir()&quot;">Next message</a> ]
[ <a href="10933.html" title="Shawn Jefferson: &quot;RE: [cc65] dio_query_sectcount() on Atari ?&quot;">Previous message</a> ]
[ <a href="10933.html" title="Shawn Jefferson: &quot;RE: [cc65] dio_query_sectcount() on Atari ?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="10940.html" title="Shawn Jefferson: &quot;RE: [cc65] dio_query_sectcount() on Atari ?&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Oliver Schmidt &lt;<a href="mailto:ol.sc1web.de?Subject=Re:%20[cc65]%20dio_query_sectcount()%20on%20Atari%20?">ol.sc1web.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2012-10-19 16:29:38</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>Hi,

&gt; That's what I did in one of the tools I implemented that uses DIO to copy
&gt; disks... there's no telling exactly if your disk will have 720 sectors, 1040
&gt; sectors, or some other number depending on strange emulator-based disk
&gt; formats (Atari disks can go up to 65535 sectors with some popular DOSes.)  I
&gt; just read until I get an error (after three retries) and then call that the
&gt; end of the disk copy.

That's interesting. Usually DOSes of the type we're talking here about
use some bitmap to mark free and used sectors. And the DOS needs to
know how large that bitmap is in order to know where to stop reading
bits when i.e. looking for a free sector. Typically that information
(if nothing else helps) can be used to quite easily find out the
number of sectors present.

Just out of curiosity: Is it possible to explain to a non-Atari
insider in in reasonable length why such an approach doesn't work on
the Atari?

&gt; Personally, I'd prefer to see a routine that works 100% of the time,
&gt; regardless of disk format so that the function returns what the programmer
&gt; thinks it will return: the number of sectors on the disk.  If the programmer
&gt; doesn't like the standard way this is done, they can always write their own
&gt; routine and accept the incompatibility and special cases such a custom
&gt; routine would entail.

A dio_query_sectcount() that does something smart im most/many cases
and falls back to some brute force approach if nothing else helps
would be fine for me too - with the one exception of reading all
sectors until a failure happens, because that should rather be done by
the application itself.

Regards,
Oliver
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Fri Oct 19 16:30:51 2012</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="10935.html" title="Next message in the list">silverdr1wfmh.org.pl: "Re: [cc65] Goodbye _curunit, Hello chdir()"</a></li>
<li><dfn>Previous message</dfn>: <a href="10933.html" title="Previous message in the list">Shawn Jefferson: "RE: [cc65] dio_query_sectcount() on Atari ?"</a></li>
<li><dfn>In reply to</dfn>: <a href="10933.html" title="Message to which this message replies">Shawn Jefferson: "RE: [cc65] dio_query_sectcount() on Atari ?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="10940.html" title="Next message in this discussion thread">Shawn Jefferson: "RE: [cc65] dio_query_sectcount() on Atari ?"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="10940.html" title="Message sent in reply to this message">Shawn Jefferson: "RE: [cc65] dio_query_sectcount() on Atari ?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#10934" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#10934" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#10934" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2012-10-19 16:30:55 CEST
</em></small></p>
</body>
</html>
