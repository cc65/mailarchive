<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="hypermail 2.1.8, see http://www.hypermail.org/" />
<title>cc65 mailing list archive: Re: [cc65] Romable configuration / ru</title>
<meta name="Author" content="Ullrich von Bassewitz (uz1musoftware.de)" />
<meta name="Subject" content="Re: [cc65] Romable configuration / run-time library?" />
<meta name="Date" content="2013-01-18" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
</style>
</head>
<body>
<div class="head">
<h1>Re: [cc65] Romable configuration / run-time library?</h1>
<!-- received="Fri Jan 18 23:29:25 2013" -->
<!-- isoreceived="20130118222925" -->
<!-- sent="Fri, 18 Jan 2013 23:29:06 +0100" -->
<!-- isosent="20130118222906" -->
<!-- name="Ullrich von Bassewitz" -->
<!-- email="uz1musoftware.de" -->
<!-- subject="Re: [cc65] Romable configuration / run-time library?" -->
<!-- id="20130118222906.GA5510@trixie.musoftware.de" -->
<!-- charset="utf-8" -->
<!-- inreplyto="CABNV55wWnBovQawwUae799nJ4OfzHVqkP64DeqHMnCSkiUoirQ&#64;mail.gmail.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ <a href="#options2">More options</a> ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="11112.html" title="Ullrich von Bassewitz: &quot;Re: [cc65] Romable configuration / run-time library?&quot;">Next message</a> ]
[ <a href="11110.html" title="Darryl Sokoloski: &quot;Re: [cc65] Romable configuration / run-time library?&quot;">Previous message</a> ]
[ <a href="11110.html" title="Darryl Sokoloski: &quot;Re: [cc65] Romable configuration / run-time library?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
 [ <a href="11113.html" title="Darryl Sokoloski: &quot;Re: [cc65] Romable configuration / run-time library?&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Ullrich von Bassewitz &lt;<a href="mailto:uz1musoftware.de?Subject=Re:%20[cc65]%20Romable%20configuration%20/%20run-time%20library?">uz1musoftware.de</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: 2013-01-18 23:29:06</span><br />
</address>
<pre id="body">
<a name="start" accesskey="j" id="start"></a>On Fri, Jan 18, 2013 at 05:20:31PM -0500, Darryl Sokoloski wrote:
&gt; Yup, that's a bug... though I was lucky and $8F (the address) did
&gt; contain a zero!  That load was from my copy/pasting generated
&gt; assembler from memcpy().  It's been a while, slowly starting to
&gt; remember my 6502 :)

Not copying the data segment might explain the error. vcprintf contains the
following structure in DATA:

outdesc:                        ; Static outdesc structure
        .word   0               ; ccount
        .word   out             ; Output function pointer
        .word   0               ; ptr
        .word   0               ; uns

A pointer to this structure is passed to __printf, which will copy the second
word (the point to the output function) into CallOutFunc. So if your data
segment isn't initialized, this vector will contain garbage.

The code that copies the vector looks like this (it's near the start of
__printf if you want to trace it):

        iny
        lda     (OutData),y
        sta     CallOutFunc+1
        iny
        lda     (OutData),y
        sta     CallOutFunc+2

You might want to trace through the function again, and this time check if the
vector stored here is already invalid (which means that the problem is
probably caused by missing data segment initialization), or corrupted later.

Regards


        Uz


-- 
Ullrich von Bassewitz                                  uz&#64;musoftware&#46;<!--nospam-->de
----------------------------------------------------------------------
To unsubscribe from the list send mail to majordomo&#64;musoftware&#46;<!--nospam-->de with
the string &quot;unsubscribe cc65&quot; in the body(!) of the mail.
</pre>
<span id="received"><dfn>Received on</dfn> Fri Jan 18 23:29:25 2013</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="11112.html" title="Next message in the list">Ullrich von Bassewitz: "Re: [cc65] Romable configuration / run-time library?"</a></li>
<li><dfn>Previous message</dfn>: <a href="11110.html" title="Previous message in the list">Darryl Sokoloski: "Re: [cc65] Romable configuration / run-time library?"</a></li>
<li><dfn>In reply to</dfn>: <a href="11110.html" title="Message to which this message replies">Darryl Sokoloski: "Re: [cc65] Romable configuration / run-time library?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="11113.html" title="Next message in this discussion thread">Darryl Sokoloski: "Re: [cc65] Romable configuration / run-time library?"</a></li>
<li><a name="replies" id="replies"></a><dfn>Reply</dfn>:  <a href="11113.html" title="Message sent in reply to this message">Darryl Sokoloski: "Re: [cc65] Romable configuration / run-time library?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="date.html#11111" title="Contemporary messages by date">By Date</a> ] [ <a href="index.html#11111" title="Contemporary discussion threads">By Thread</a> ] [ <a href="subject.html#11111" title="Contemporary messages by subject">By Subject</a> ]</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail.org/">hypermail 2.1.8</a> 
: 2013-01-18 23:29:28 CET
</em></small></p>
</body>
</html>
